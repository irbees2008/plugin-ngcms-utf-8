# =========================================================================== #
# NG CMS // Плагины // guestbook                                           #
# =========================================================================== #

Плагин позволяет организовать на сайте гостевую книгу.

При активации плагина становится доступна страница плагина: /plugin/guestbook/

Настройка плагина
=====================

[TWIG] guestbook.list.tpl
------------------------------------------------
Шаблон используется для вывода списка записей гостевой книги и формы добавления записи.

Список переменных:

  * entries - массив, содержащий записи гостевой книги:
    * id            - ID записи
    * comnum        - порядковый номер записи
    * date          - дата публикации записи (в формате, указанном в настройках плагина)
    * message       - текст записи
    * answer        - ответ администратора
    * author        - логин автора записи, либо guest (гость)
    * ip            - ip-адрес автора записи
    * edit          - ссылка на редактирование записи (для администратора)
    * del           - ссылка на удаление записи (для администратора)
    * fields        - массив с заполненными данными доп. полей записи (ключ - id поля):
      * id          - id поля
      * name        - название поля
      * value       - значение поля
    
  * fields  - массив всех доп. полей гостевой книги (ключ - id поля):
    * id            - id поля,
    * name          - название поля;
    * placeholder   - заполнитель поля;
    * default_value - значение поля по умолчанию;
    * required      - является ли поле обязательным;

  * total_count     - общее количество записей в гостевой книге
  * perpage         - количество записей, отображаемых на одной странице
  * errors          - сообщения об ошибках
  * success         - сообщения об успешных действиях
  * smilies         - смайлы
  * bbcodes         - BB-коды
  * ip              - ip-адрес пользователя (используется при публикации записи)
  * use_captcha     - true, если капча включена
  * use_guests      - true, если разрешено добавлять записи без входа на сайт
  * pages           - виджет постраничной навигации

[TWIG] guestbook.edit.tpl
------------------------------------------------
Шаблон используется для редактирования записи без входа в админку.
Предоставляет урезанные возможности - в частности, нельзя редактировать данные соцсетей.

Список переменных:

  * id              - ID записи
  * author          - логин автора записи, либо guest (гость)
  * message         - текст записи
  * answer          - ответ администратора
  * error           - сообщения об ошибках
  * fields  - массив всех доп. полей записи (ключ - id поля)
    * id            - id поля
    * name          - название поля
    * placeholder   - заполнитель поля
    * default_value - значение поля по умолчанию
    * required      - является ли поле обязательным
    * value         - значение, указанное автором записи

[TWIG] guestbook.block.tpl
------------------------------------------------
Шаблон используется для вывода блока последних записей в main.tpl.
Записи содержатся в переменной entries, структура подобна шаблону guestbook.list.tpl

Для вывода блока использовать конструкцию:

  {{ callPlugin('guestbook.show', {'count': '2'}) }}

где count - необходимое количество записей.

Настройки ЧПУ
---------------------

Вы можете указать собственные адреса страниц плагина. Для этого необходимо:
  1. включить ЧПУ в настройках плагина,
  2. прописать параметры URL для плагина guestbook в "Управление форматом ссылок".

Пример:

guestbook   edit    Редактирование    /guestbook/edit/{id}
guestbook           Гостевая книга    /guestbook/[{page}/][{act}]

Где:
  - {id}      для страницы редактирования: ID редактируемой записи
  - {page}    для страницы списка записей: номер страницы
  - {act}     для страницы списка записей: успешно выполнено действие (add = запись добавлена, upd = запись отредактирована, del = запись удалена)

Настройки привязки 
---------------------

1. Плагин поддерживает авторизацию только через сайт

